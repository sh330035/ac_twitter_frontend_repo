(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-418d3724"],{"4ef5":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"setting"},[e("section",{staticClass:"center-view"},[e("PageNameBanner",{attrs:{"banner-title":a.bannerTitle}}),e("ScaleLoader",{attrs:{"is-loading":a.isLoading}}),a.isLoading?a._e():e("account-setting-form",{attrs:{"initial-account-detail":a.accountDetail,"is-processing":a.isProcessing},on:{"after-form-submit":a.afterFormSubmit}})],1),e("Toast",{attrs:{ToastMessage:a.ToastMessage}})],1)},o=[],i=e("5530"),r=e("1da1"),n=(e("96cf"),e("ccfa")),c=e("7424"),l=e("2612"),m=e("de64"),u=e("a0e7"),d={name:"Setting",components:{PageNameBanner:c["a"],AccountSettingForm:n["a"],Toast:m["a"],ScaleLoader:u["a"]},data:function(){return{bannerTitle:"帳戶設定",accountDetail:{id:-1,account:"",name:"",email:"",password:"",passwordCheck:"",role:"user"},isProcessing:!1,ToastMessage:{message:"",dataStatus:""},isLoading:!0}},created:function(){this.isLoading=!0;var a=this.$route.id;this.fetchUserAccountDetail(a)},methods:{fetchUserAccountDetail:function(a){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].getCurrentUser(a);case 3:s=e.sent,o=s.data,t.accountDetail=Object(i["a"])(Object(i["a"])({},t.accountDetail),o),t.isLoading=!1,e.next=15;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log("error:",e.t0),t.ToastMessage.message="無法取得設定資料，請稍後再試",t.ToastMessage.dataStatus="error",t.isLoading=!1;case 15:case"end":return e.stop()}}),e,null,[[0,9]])})))()},afterFormSubmit:function(a){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var s,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.isProcessing=!0,s=t.accountDetail.id,e.next=5,l["a"].updateUserSetting({userId:s,formData:a});case 5:if(o=e.sent,i=o.data,console.log(i),"success"===i.status){e.next=10;break}throw new Error(i.message);case 10:t.ToastMessage.message="個人設定已成功更新",t.ToastMessage.dataStatus="success",t.isProcessing=!1,setTimeout((function(){t.$router.push({name:"user",params:{id:s}})}),1200),e.next=23;break;case 16:e.prev=16,e.t0=e["catch"](0),console.log("error:",e.t0),t.ToastMessage.dataStatus="",t.ToastMessage.message="".concat(e.t0.message),t.ToastMessage.dataStatus="error",setTimeout((function(){t.isProcessing=!1}),2400);case 23:case"end":return e.stop()}}),e,null,[[0,16]])})))()}}},f=d,g=e("2877"),h=Object(g["a"])(f,s,o,!1,null,null,null);t["default"]=h.exports},ccfa:function(a,t,e){"use strict";var s=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("form",{staticClass:"account-setting-form",attrs:{action:"",novalidate:""},on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),a.handleFormSubmit.apply(null,arguments)}}},[e("div",{staticClass:"form-row"},[e("label",{staticClass:"form-row__label",attrs:{for:"account"}},[a._v(" 帳號 ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.accountDetail.account,expression:"accountDetail.account"}],staticClass:"form-row__input",class:{invalid:a.formValidation.account.error},attrs:{id:"account",type:"text",name:"account",required:""},domProps:{value:a.accountDetail.account},on:{input:function(t){t.target.composing||a.$set(a.accountDetail,"account",t.target.value)}}}),a.formValidation.account.error?e("div",{staticClass:"form-row__error-message"},[a._v(" "+a._s(a.formValidation.account.message)+" ")]):a._e()]),e("div",{staticClass:"form-row"},[e("label",{staticClass:"form-row__label",attrs:{for:"name"}},[a._v(" 名稱 ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.accountDetail.name,expression:"accountDetail.name"}],staticClass:"form-row__input",class:{invalid:a.formValidation.name.error},attrs:{id:"name",type:"text",name:"name",required:""},domProps:{value:a.accountDetail.name},on:{input:function(t){t.target.composing||a.$set(a.accountDetail,"name",t.target.value)}}}),e("div",{staticClass:"form-row__length-counter"},[e("span",{staticClass:"form-row__length-counter__current-length"},[a._v(" "+a._s(a.accountDetail.name.length)+" ")]),e("span",{staticClass:"form-row__length-counter__length-limit"},[a._v(" / "+a._s(a.formValidation.name.lengthLimit)+" ")])]),a.formValidation.name.error?e("div",{staticClass:"form-row__error-message"},[a._v(" "+a._s(a.formValidation.name.message)+" ")]):a._e()]),e("div",{staticClass:"form-row"},[e("label",{staticClass:"form-row__label",attrs:{for:"email"}},[a._v(" Email ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.accountDetail.email,expression:"accountDetail.email"}],staticClass:"form-row__input",class:{invalid:a.formValidation.email.error},attrs:{id:"email",type:"email",name:"email",required:""},domProps:{value:a.accountDetail.email},on:{input:function(t){t.target.composing||a.$set(a.accountDetail,"email",t.target.value)}}}),a.formValidation.email.error?e("div",{staticClass:"form-row__error-message"},[a._v(" "+a._s(a.formValidation.email.message)+" ")]):a._e()]),e("div",{staticClass:"form-row"},[e("label",{staticClass:"form-row__label",attrs:{for:"password"}},[a._v(" 密碼 ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.accountDetail.password,expression:"accountDetail.password"}],staticClass:"form-row__input",class:{invalid:a.formValidation.password.error},attrs:{id:"password",type:"password",name:"password",required:""},domProps:{value:a.accountDetail.password},on:{input:function(t){t.target.composing||a.$set(a.accountDetail,"password",t.target.value)}}}),a.formValidation.password.error?e("div",{staticClass:"form-row__error-message"},[a._v(" "+a._s(a.formValidation.password.message)+" ")]):a._e()]),e("div",{staticClass:"form-row"},[e("label",{staticClass:"form-row__label",attrs:{for:"checkPassword"}},[a._v(" 密碼確認 ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.accountDetail.checkPassword,expression:"accountDetail.checkPassword"}],staticClass:"form-row__input",class:{invalid:a.formValidation.checkPassword.error},attrs:{id:"checkPassword",type:"password",name:"checkPassword",required:""},domProps:{value:a.accountDetail.checkPassword},on:{input:function(t){t.target.composing||a.$set(a.accountDetail,"checkPassword",t.target.value)}}}),a.formValidation.checkPassword.error?e("div",{staticClass:"form-row__error-message"},[a._v(" "+a._s(a.formValidation.checkPassword.message)+" ")]):a._e()]),e("button",{staticClass:"account-setting-form__submit-btn btn",attrs:{disabled:a.isProcessing||a.formValidation.name.error,type:"submit"}},[a._v(" "+a._s(a.initialAccountDetail?"儲存":"註冊")+" ")])])},o=[],i=e("5530"),r=(e("b0c0"),e("b64b"),e("d3b7"),e("159b"),e("498a"),e("caad"),e("2532"),{name:"AccountSettingForm",props:{initialAccountDetail:{type:Object},isProcessing:{type:Boolean,default:!1},clearPasswordInput:{type:Boolean,default:!1}},data:function(){return{accountDetail:{account:"",name:"",email:"",password:"",checkPassword:"",role:"user"},formValidation:{account:{error:!1,message:"test"},name:{lengthLimit:50,error:!1,message:""},email:{error:!1,message:""},password:{error:!1,message:""},checkPassword:{error:!1,message:""}}}},created:function(){this.updateAccountDetail()},watch:{initialAccountDetail:function(){this.updateAccountDetail()},"accountDetail.name":function(){this.accountDetail.name.length>this.formValidation.name.lengthLimit?(this.formValidation.name.error=!0,this.formValidation.name.message="字數超過限制"):this.formValidation.name.error=!1},clearPasswordInput:function(){this.clearPasswordInput&&this.clearInput()}},methods:{updateAccountDetail:function(){this.accountDetail=Object(i["a"])(Object(i["a"])(Object(i["a"])({},this.accountDetail),this.initialAccountDetail),{},{password:""})},handleFormSubmit:function(){var a=this,t=Object.keys(this.formValidation);return t.forEach((function(t){a.formValidation[t].error=!1,a.formValidation[t].message=""})),0===this.accountDetail.account.trim().length?(this.formValidation.account.error=!0,void(this.formValidation.account.message="請填入帳號")):0===this.accountDetail.name.trim().length?(this.formValidation.name.error=!0,void(this.formValidation.name.message="請填入名稱")):0===this.accountDetail.email.trim().length?(this.formValidation.email.error=!0,void(this.formValidation.email.message="請填入信箱")):this.accountDetail.email.includes("@")&&this.accountDetail.email.includes(".com")?0===this.accountDetail.password.trim().length?(this.formValidation.password.error=!0,void(this.formValidation.password.message="請填入密碼")):0===this.accountDetail.checkPassword.trim().length?(this.formValidation.checkPassword.error=!0,void(this.formValidation.checkPassword.message="請再次填入密碼已進行確認")):this.accountDetail.password!==this.accountDetail.checkPassword?(this.formValidation.checkPassword.error=!0,this.formValidation.checkPassword.message="密碼不相符，請重新確認",void(this.accountDetail.checkPassword="")):void this.$emit("after-form-submit",this.accountDetail):(this.formValidation.email.error=!0,void(this.formValidation.email.message="請填入正確的信箱格式"))},clearInput:function(){this.accountDetail.password="",this.accountDetail.checkPassword=""}}}),n=r,c=e("2877"),l=Object(c["a"])(n,s,o,!1,null,null,null);t["a"]=l.exports}}]);
//# sourceMappingURL=chunk-418d3724.c750e739.js.map