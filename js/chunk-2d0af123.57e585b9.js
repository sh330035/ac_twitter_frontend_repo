(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0af123"],{"0d81":function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"test-page"},[o("section",{staticClass:"center-view"},[o("PageNameBanner",{attrs:{user:e.user}}),o("FollowsNavPills"),o("ScaleLoader",{attrs:{"is-loading":e.isLoading}}),e.isLoading?e._e():o("FollowList",{attrs:{follows:e.follows},on:{"after-add-follow":e.addFollowing,"after-delete-follow":e.deleteFollowing}})],1),o("section",{staticClass:"right-card"},[o("PopularUsersCard")],1)])},l=[],a=o("5530"),r=o("1da1"),n=(o("96cf"),o("b0c0"),o("d81d"),o("5a23")),i=o("7424"),c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ul",{staticClass:"follow-navPills d-flex"},[o("li",{staticClass:"follow-navPills__item"},[o("router-link",{staticClass:"link follow-navPills__item__link navpill-text",attrs:{to:{name:"user-follow"}}},[e._v("跟隨者")])],1),o("li",{staticClass:"follow-navPills__item"},[o("router-link",{staticClass:"link follow-navPills__item__link navpill-text",attrs:{to:{name:"user-follow",query:{follow:"following"}}}},[e._v("正在跟隨")])],1),o("div",{staticClass:"border"})])},u=[],f=o("2877"),d={},w=Object(f["a"])(d,c,u,!1,null,null,null),p=w.exports,_=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"follow"},e._l(e.follows,(function(t){return o("div",{key:t.id,staticClass:"follow__list d-flex"},[o("span",[o("img",{staticClass:"follow__list__image avatar-50",attrs:{src:t.avatar,alt:""},on:{click:function(o){return o.preventDefault(),o.stopPropagation(),e.toUserPage(t.id)}}})]),o("div",{staticClass:"follow__list__container d-flex-col"},[o("div",{staticClass:"follow__list__user"},[o("h2",{staticClass:"follow__list__user__name user-name-text",on:{click:function(o){return o.preventDefault(),o.stopPropagation(),e.toUserPage(t.id)}}},[e._v(" "+e._s(t.name)+" ")]),o("span",{staticClass:"follow__list__user__account user-account-text"},[e._v(e._s(e._f("accountTag")(t.account)))])]),o("div",{staticClass:"follow__list__descriptoion"},[o("p",{staticClass:"description-15"},[e._v(" "+e._s(t.introduction)+" ")])])]),o("div",{staticClass:"follow__list__button"},[t.isFollowed||e.currentUser.id==t.id?t.isFollowed&&e.currentUser.id!=t.id?o("button",{staticClass:"btn-following",on:{click:function(o){return o.preventDefault(),o.stopPropagation(),e.deleteFollowhandler(t.id)}}},[e._v(" 正在跟隨 ")]):e._e():o("button",{staticClass:"btn-follow",on:{click:function(o){return o.preventDefault(),o.stopPropagation(),e.addFollowhandler(t.id)}}},[e._v(" 跟隨 ")])])])})),0)},h=[],v=o("2708"),g=o("2f62"),m={name:"follow-list",props:{follows:{type:Array,required:!0}},computed:Object(a["a"])({},Object(g["b"])(["currentUser"])),mixins:[v["b"],v["a"]],methods:{toUserPage:function(e){this.$router.push({name:"user",params:{id:e}})},addFollowhandler:function(e){this.$emit("after-add-follow",e)},deleteFollowhandler:function(e){this.$emit("after-delete-follow",e)}}},b=m,x=Object(f["a"])(b,_,h,!1,null,null,null),k=x.exports,C=o("a0e7"),F=o("2612"),P={name:"user-follow",components:{PopularUsersCard:n["a"],PageNameBanner:i["a"],FollowsNavPills:p,FollowList:k,ScaleLoader:C["a"]},data:function(){return{user:{id:-1,account:"",name:"",tweetsCount:-1},follows:[],followPageStatus:"",isLoading:!0}},beforeRouteUpdate:function(e,t,o){var s=e.query.follow?e.query.follow:"followers";this.followPageStatus=s,this.fetchUserFollow(this.user.id,s),o()},created:function(){this.isLoading=!0;var e=this.$route.params.id,t=this.$route.query.follow,o=void 0===t?"":t;this.followPageStatus=o?"following":"followers",this.fetchUserFollow(parseInt(e,10),this.followPageStatus),this.fetchUsers(parseInt(e,10))},watch:{isRender:{handler:function(){var e=this.user.id,t=this.$route.query.follow,o=void 0===t?"":t;this.followPageStatus=o?"following":"followers",this.fetchUserFollow(parseInt(e,10),this.followPageStatus)},deep:!0}},methods:{fetchUsers:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function o(){var s,l;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,F["a"].getUser({userId:e});case 3:s=o.sent,l=s.data,t.user={id:l.id,account:l.account,name:l.name,tweetsCount:l.TweetCount},o.next=11;break;case 8:o.prev=8,o.t0=o["catch"](0),console.log(o.t0);case 11:case"end":return o.stop()}}),o,null,[[0,8]])})))()},fetchUserFollow:function(e,t){var o=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){var l,a,r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(s.prev=0,"following"!=t){s.next=11;break}return s.next=4,F["a"].getUserFollowings(e);case 4:return l=s.sent,a=l.data,o.follows=a,o.isLoading=!1,s.abrupt("return");case 11:if("followers"!=t){s.next=21;break}return s.next=14,F["a"].getUserFollowers(e);case 14:return r=s.sent,n=r.data,o.follows=n,o.isLoading=!1,s.abrupt("return");case 21:throw new Error;case 22:s.next=28;break;case 24:s.prev=24,s.t0=s["catch"](0),console.log(s.t0),o.isLoading=!1;case 28:case"end":return s.stop()}}),s,null,[[0,24]])})))()},addFollowing:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function o(){var s,l,r;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(o.prev=0,s={id:e},t.currentUser.id!=e){o.next=4;break}throw new Error("無法自己追蹤自己");case 4:return o.next=6,F["a"].addFollowing({id:s});case 6:if(l=o.sent,r=l.data,"success"===r.status){o.next=10;break}throw new Error(r.message);case 10:t.$store.commit("render"),t.follows=t.follows.map((function(t){return t.id!==e?t:Object(a["a"])(Object(a["a"])({},t),{},{isFollowed:!0})})),o.next=17;break;case 14:o.prev=14,o.t0=o["catch"](0),console.log(o.t0);case 17:case"end":return o.stop()}}),o,null,[[0,14]])})))()},deleteFollowing:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function o(){var s,l;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,F["a"].deleteFollowing({userId:e});case 3:if(s=o.sent,l=s.data,"success"===l.status){o.next=7;break}throw new Error(l.message);case 7:t.$store.commit("render"),t.follows=t.follows.map((function(t){return t.id!==e?t:Object(a["a"])(Object(a["a"])({},t),{},{isFollowed:!1})})),o.next=14;break;case 11:o.prev=11,o.t0=o["catch"](0),console.log(o.t0);case 14:case"end":return o.stop()}}),o,null,[[0,11]])})))()}},computed:Object(a["a"])({},Object(g["b"])(["currentUser","isRender"]))},U=P,j=Object(f["a"])(U,s,l,!1,null,null,null);t["default"]=j.exports}}]);
//# sourceMappingURL=chunk-2d0af123.57e585b9.js.map